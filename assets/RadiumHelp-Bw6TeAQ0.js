import{u as I,r as C,j as e,H as D,F as E}from"./index-Cpundhhs.js";const k=s=>s<=.04045?s/12.92:((s+.055)/1.055)**2.4,H=s=>s<=.0031308?12.92*s:1.055*s**(1/2.4)-.055,T=s=>Math.max(0,Math.min(1,s)),W=({r:s,g:t,b:o})=>{const a=k(s),i=k(t),r=k(o),n=Math.cbrt(.4122214708*a+.5363325363*i+.0514459929*r),c=Math.cbrt(.2119034982*a+.6806995451*i+.1073969566*r),x=Math.cbrt(.0883024619*a+.2817188376*i+.6299787005*r);return{L:.2104542553*n+.793617785*c-.0040720468*x,a:1.9779984951*n-2.428592205*c+.4505937099*x,b:.0259040371*n+.7827717662*c-.808675766*x}},L=({L:s,a:t,b:o})=>{const a=s+.3963377774*t+.2158037573*o,i=s-.1055613458*t-.0638541728*o,r=s-.0894841775*t-1.291485548*o,n=a*a*a,c=i*i*i,x=r*r*r;return{r:H(4.0767416621*n-3.3077115913*c+.2309699292*x),g:H(-1.2684380046*n+2.6097574011*c-.3413193965*x),b:H(-.0041960863*n-.7034186147*c+1.707614701*x)}},R=s=>{const{r:t,g:o,b:a}=L(s);return{r:T(t),g:T(o),b:T(a)}},B=s=>({r:parseInt(s.slice(1,3),16)/255,g:parseInt(s.slice(3,5),16)/255,b:parseInt(s.slice(5,7),16)/255}),M=({r:s,g:t,b:o})=>"#"+[s,t,o].map(a=>Math.round(T(a)*255).toString(16).padStart(2,"0")).join(""),N=s=>{const t=W(B(s));return{L:t.L,C:Math.sqrt(t.a**2+t.b**2),H:(Math.atan2(t.b,t.a)*180/Math.PI+360)%360}},b=s=>{const t=r=>r.r>=-.001&&r.r<=1.001&&r.g>=-.001&&r.g<=1.001&&r.b>=-.001&&r.b<=1.001,o=r=>{const n=s.H*Math.PI/180;return{L:s.L,a:r*Math.cos(n),b:r*Math.sin(n)}};if(t(L(o(s.C))))return M(R(o(s.C)));let a=0,i=s.C;for(let r=0;r<24;r++){const n=(a+i)/2;t(L(o(n)))?a=n:i=n}return M(R(o(a)))},O=({r:s,g:t,b:o})=>.2126*k(s)+.7152*k(t)+.0722*k(o),F=(s,t)=>{const o=O(B(s)),a=O(B(t));return(Math.max(o,a)+.05)/(Math.min(o,a)+.05)},$=s=>F(s,"#ffffff")>=F(s,"#111111")?"#ffffff":"#111111",P=(s,t)=>{const o=N(s);switch(t){case"neutralLight":return b({...o,L:.93,C:Math.min(o.C*.08,.015)});case"neutralDark":return b({...o,L:.1,C:Math.min(o.C*.08,.015)});case"mainColor":return b({...o,L:.52,C:Math.max(o.C,.22)});case"mainColorShade":return b({...o,L:.3,C:o.C});case"accentColor":return b({...o,L:.62,C:Math.max(o.C,.22)})}},f={neutralLight:"#88ff00",neutralDark:"#0e1626",mainColor:"#0008ff",mainColorShade:"#ff7700",accentColor:"#f87f01"},v=Object.fromEntries(Object.entries(f).map(([s,t])=>[s,P(t,s)]));function V({hex:s,label:t,size:o=40}){const[a,i]=C.useState(!1),r=()=>{navigator.clipboard.writeText(s),i(!0),setTimeout(()=>i(!1),1200)};return e.jsxs("div",{className:"rad-swatch",style:{"--swatch-size":`${o}px`},onClick:r,title:`${s}${t?` — ${t}`:""}`,children:[e.jsx("div",{className:"rad-swatch-block",style:{background:s,width:o,height:o}}),t&&e.jsx("span",{className:"rad-swatch-label",style:{color:"inherit",opacity:.6,fontSize:10},children:a?"copied!":t})]})}function S({code:s,lang:t="ts"}){const[o,a]=C.useState(!1);return e.jsxs("div",{className:"rad-code-block",children:[e.jsx("button",{className:"rad-code-copy",onClick:()=>{navigator.clipboard.writeText(s),a(!0),setTimeout(()=>a(!1),1500)},children:o?"✓":"copy"}),e.jsx("pre",{children:e.jsx("code",{className:`lang-${t}`,children:s})})]})}function y({number:s,title:t,accent:o}){return e.jsxs("div",{className:"rad-section-header",children:[e.jsx("span",{className:"rad-section-num",style:{color:o},children:s}),e.jsx("h2",{className:"rad-section-title",children:t})]})}function w({inputHex:s,outputHex:t,label:o,targetL:a,targetC:i}){const r=N(s),n=N(t);return e.jsxs("div",{className:"rad-transform-row",children:[e.jsxs("div",{className:"rad-transform-before",children:[e.jsx("div",{className:"rad-transform-swatch",style:{background:s}}),e.jsxs("div",{className:"rad-transform-info",children:[e.jsx("code",{children:s}),e.jsxs("span",{children:["L=",r.L.toFixed(3)," C=",r.C.toFixed(3)]})]})]}),e.jsx("div",{className:"rad-transform-arrow",children:"→"}),e.jsxs("div",{className:"rad-transform-after",children:[e.jsx("div",{className:"rad-transform-swatch",style:{background:t}}),e.jsxs("div",{className:"rad-transform-info",children:[e.jsx("code",{children:t}),e.jsxs("span",{children:["L=",n.L.toFixed(3)," C=",n.C.toFixed(3)]})]})]}),e.jsxs("div",{className:"rad-transform-rule",children:[e.jsx("strong",{children:o}),e.jsxs("span",{children:["L → ",a," · C → ",i]})]})]})}function K({th:s}){const[t,o]=C.useState(.62),[a,i]=C.useState(.18),[r,n]=C.useState(250),c=b({L:t,C:a,H:r}),x=M(R({L:t,a:a*Math.cos(r*Math.PI/180),b:a*Math.sin(r*Math.PI/180)})),l=c!==x,h=$(c),d=(u,m,p,g,j,z,G)=>e.jsxs("div",{className:"rad-slider-row",children:[e.jsx("span",{className:"rad-slider-label",children:u}),e.jsx("input",{type:"range",min:p,max:g,step:j,value:m,onChange:A=>z(parseFloat(A.target.value)),style:{"--slider-color":G},className:"rad-slider"}),e.jsx("span",{className:"rad-slider-val",children:m.toFixed(3)})]});return e.jsxs("div",{className:"rad-explorer",style:{background:s.panelBg,border:`1px solid ${s.border}`},children:[e.jsxs("div",{className:"rad-explorer-preview",style:{background:c},children:[e.jsx("span",{style:{color:h,fontSize:13,fontWeight:600,fontFamily:"system-ui, sans-serif"},children:c}),l&&e.jsx("span",{style:{color:h,fontSize:10,opacity:.7,fontFamily:"system-ui, sans-serif"},children:"· chroma clamped for sRGB"})]}),e.jsxs("div",{className:"rad-explorer-controls",children:[d("L — Lightness",t,0,1,.001,o,"#a78bfa"),d("C — Chroma",a,0,.4,.001,i,"#34d399"),d("H — Hue °",r,0,360,1,n,"#fb923c"),e.jsxs("div",{className:"rad-explorer-lch-display",style:{color:s.body},children:[e.jsxs("span",{children:["OKLCH(",t.toFixed(3),", ",a.toFixed(3),", ",r.toFixed(0),"°)"]}),e.jsxs("span",{style:{opacity:.5,fontSize:10},children:["wcag contrast on white: ",F(c,"#ffffff").toFixed(1),":1"]})]})]})]})}function U({H:s,th:t}){const i=[],r=[];for(let n=0;n<=100;n+=2){const c=n/100;let x=0,l=0,h=.45;const d=p=>{const g=s*Math.PI/180,j=L({L:c,a:p*Math.cos(g),b:p*Math.sin(g)});return j.r>=-.001&&j.r<=1.001&&j.g>=-.001&&j.g<=1.001&&j.b>=-.001&&j.b<=1.001};for(let p=0;p<20;p++){const g=(l+h)/2;d(g)?l=g:h=g}x=l;const u=x/.45*280,m=180-c*180;i.push(`${u},${m}`)}for(let n=5;n<=95;n+=10){const c=n/100;let x=0,l=.45;const h=m=>{const p=s*Math.PI/180,g=L({L:c,a:m*Math.cos(p),b:m*Math.sin(p)});return g.r>=-.001&&g.r<=1.001&&g.g>=-.001&&g.g<=1.001&&g.b>=-.001&&g.b<=1.001};for(let m=0;m<20;m++){const p=(x+l)/2;h(p)?x=p:l=p}const d=x/.45*280,u=180-c*180;r.push({x:d,y:u,hex:b({L:c,C:x*.85,H:s})})}return e.jsxs("div",{className:"rad-gamut-slice",style:{background:t.panelBg,border:`1px solid ${t.border}`},children:[e.jsxs("div",{className:"rad-gamut-title",style:{color:t.h2},children:["sRGB gamut at H=",s.toFixed(0),"°"]}),e.jsxs("svg",{width:280,height:180,style:{display:"block"},children:[e.jsx("rect",{width:280,height:180,fill:t.panelBg}),[.2,.4,.6,.8].map(n=>e.jsx("line",{x1:0,y1:180-n*180,x2:280,y2:180-n*180,stroke:t.border,strokeWidth:.5},n)),e.jsx("polygon",{points:`0,180 ${i.join(" ")} 0,0`,fill:"rgba(99,102,241,0.08)",stroke:"rgba(99,102,241,0.5)",strokeWidth:1.5}),r.map(({x:n,y:c,hex:x},l)=>e.jsx("circle",{cx:n*.85,cy:c,r:5,fill:x},l)),e.jsx("text",{x:4,y:12,fill:t.h2,fontSize:8,fontFamily:"monospace",children:"L=1.0"}),e.jsx("text",{x:4,y:176,fill:t.h2,fontSize:8,fontFamily:"monospace",children:"L=0.0"}),e.jsx("text",{x:250,y:176,fill:t.h2,fontSize:8,fontFamily:"monospace",children:"C=0.45"})]})]})}function q(){const{isDark:s}=I(),[t,o]=C.useState(49),a={pageBg:s?"#0d0f14":"#f0f4f8",pageText:s?"#dde3ef":"#1e293b",h1:s?"#f1f5f9":"#0f172a",h2:s?"#94a3b8":"#64748b",body:s?"#cbd5e1":"#334155",label:s?"#f1f5f9":"#0f172a",desc:s?"#94a3b8":"#64748b",faint:s?"#334155":"#94a3b8",panelBg:s?"#161b27":"#ffffff",border:s?"#2a3347":"#e2e8f0",codeBg:s?"#0f1623":"#f0f4ff",codeText:s?"#a5b4fc":"#3730a3",highlight:s?"#1e2a42":"#eff6ff",h2Border:s?"#1e293b":"#e2e8f0"},i="#a78bfa",r="#34d399",n="#fb923c",c="#38bdf8",x=["neutralLight","neutralDark","mainColor","mainColorShade","accentColor"];return e.jsxs("div",{className:"rad-page",style:{background:a.pageBg,color:a.pageText},children:[e.jsx(D,{}),e.jsxs("div",{className:"rad-hero",children:[e.jsx("div",{className:"rad-hero-eyebrow",children:"Color Science"}),e.jsxs("h1",{className:"rad-hero-title",children:["How Radium",e.jsx("br",{}),"Colors Are Generated"]}),e.jsx("p",{className:"rad-hero-sub",children:"A deep-dive into the OKLCH perceptual color transforms, gamut-safe clamping, and semantic token architecture that powers every Radium palette output."}),e.jsx("div",{className:"rad-hero-swatches",children:x.map(l=>e.jsxs("div",{className:"rad-hero-swatch-pair",children:[e.jsx("div",{className:"rad-hero-swatch",style:{background:f[l]},title:`Input: ${f[l]}`}),e.jsx("div",{className:"rad-hero-arrow",children:"→"}),e.jsx("div",{className:"rad-hero-swatch",style:{background:v[l]},title:`Output: ${v[l]}`}),e.jsx("span",{className:"rad-hero-swatch-label",children:l})]},l))})]}),e.jsxs("div",{className:"rad-content",style:{color:a.pageText},children:[e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"01",title:"What Is Radium?",accent:i}),e.jsxs("p",{style:{color:a.body},children:["Radium is a color palette engine that takes arbitrary brand hex values as input and returns semantically-correct design token colors as output — with zero external dependencies. Given a bag of hex strings, it produces a structured"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:"RadiumOutput"})," ","object where every key is a precisely-calibrated color, not just the input echoed back."]}),e.jsxs("p",{style:{color:a.body,marginTop:12},children:["The generator's input and output shapes are symmetric: same keys, same array lengths. A single-swatch key like"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:'mainColor: ["#ff0000"]'})," ","is transformed into its semantically correct equivalent; a 16-swatch key like"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:'monochromatic: Array(16).fill("#aaa")'})," ","expands into a full dark-to-light ramp."]}),e.jsx(S,{lang:"ts",code:`// Input — arbitrary hex values
const input: RadiumInput = {
  neutralLight:   ["#88ff00"],
  neutralDark:    ["#0e1626"],
  mainColor:      ["#0008ff"],
  mainColorShade: ["#ff7700"],
  accentColor:    ["#f87f01"],
};

// Output — semantically transformed
const output = generateRadiumColors(input);
// {
//   neutralLight:   ["#e4eae0"],  // near-white, hue ghost only
//   neutralDark:    ["#030304"],  // near-black, hue ghost only
//   mainColor:      ["#104cff"],  // vivid mid-tone
//   mainColorShade: ["#4c1f00"],  // dark shade, hue preserved exactly
//   accentColor:    ["#cb6700"],  // warm pop, vivid
// }`})]}),e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"02",title:"Why OKLCH?",accent:r}),e.jsxs("p",{style:{color:a.body},children:["Most color transforms in design tools operate in raw RGB or HSL. Both spaces have a fundamental problem:"," ",e.jsx("em",{children:"perceptual non-uniformity"}),". Moving 10 points in HSL lightness produces a barely-visible change near white and a dramatic change near black. A blue and a yellow at the same HSL lightness look nothing alike in perceived brightness."]}),e.jsx("p",{style:{color:a.body,marginTop:12},children:"OKLCH is a perceptually-uniform cylindrical color space designed by Björn Ottosson (2020). It has three axes:"}),e.jsx("div",{className:"rad-axis-cards",children:[{axis:"L",name:"Lightness",range:"0 → 1",desc:"Perceptually uniform — Δ0.1 looks the same jump at any lightness level. Black is 0, white is 1.",color:i},{axis:"C",name:"Chroma",range:"0 → ~0.4",desc:"Saturation / vividness. 0 is achromatic grey; higher values are more saturated. sRGB caps around 0.32 for most hues.",color:r},{axis:"H",name:"Hue",range:"0° → 360°",desc:"Angle on the color wheel. Red ≈ 29°, yellow ≈ 110°, green ≈ 142°, cyan ≈ 195°, blue ≈ 265°, magenta ≈ 330°.",color:n}].map(({axis:l,name:h,range:d,desc:u,color:m})=>e.jsxs("div",{className:"rad-axis-card",style:{background:a.panelBg,border:`1px solid ${a.border}`},children:[e.jsx("div",{className:"rad-axis-letter",style:{color:m},children:l}),e.jsx("div",{className:"rad-axis-name",style:{color:a.label},children:h}),e.jsx("div",{className:"rad-axis-range",style:{color:m},children:d}),e.jsx("p",{style:{color:a.desc,fontSize:12,margin:0,lineHeight:1.5},children:u})]},l))}),e.jsxs("p",{style:{color:a.body,marginTop:20},children:["Radium targets specific"," ",e.jsx("strong",{style:{color:a.label},children:"absolute L and C values"})," ","per semantic token. Because L is perceptually uniform,"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:"L=0.93"})," ","is always near-white regardless of the input, and"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:"L=0.30"})," ","is always a mid-dark. Transforms are strong and predictable because they set the destination, not nudge from the source."]}),e.jsxs("div",{style:{marginTop:24},children:[e.jsx("div",{className:"rad-callout-label",style:{color:a.faint},children:"Interactive explorer"}),e.jsx(K,{th:a})]})]}),e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"03",title:"Semantic Token Architecture",accent:n}),e.jsxs("p",{style:{color:a.body},children:["Radium recognises five semantic roles from palette key names. Each role has a specific ",e.jsx("em",{children:"L and C target"})," it enforces, while always preserving the input's hue angle H. The key is matched by normalising it to lowercase with all non-alpha characters stripped, then checking against a priority-ordered pattern table."]}),e.jsx("div",{className:"rad-token-table-wrap",children:e.jsxs("table",{className:"rad-token-table",style:{color:a.body},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{color:a.h2},children:"Key pattern"}),e.jsx("th",{style:{color:a.h2},children:"Target L"}),e.jsx("th",{style:{color:a.h2},children:"Target C"}),e.jsx("th",{style:{color:a.h2},children:"Role"})]})}),e.jsx("tbody",{children:[{pattern:"neutralLight / neutral…light",L:"0.93",C:"min(C×0.08, 0.015)",role:"Near-white with ghost tint"},{pattern:"neutralDark / neutral…dark",L:"0.10",C:"min(C×0.08, 0.015)",role:"Near-black with ghost tint"},{pattern:"neutral (generic)",L:"0.55",C:"min(C×0.06, 0.012)",role:"Mid-grey, achromatic"},{pattern:"*shade / *colorshade",L:"0.30",C:"preserved (gamut-safe)",role:"Dark vivid shade"},{pattern:"*dark",L:"0.22",C:"preserved (gamut-safe)",role:"Deeper dark"},{pattern:"*light / *tint",L:"0.88",C:"C × 0.50",role:"Soft tint"},{pattern:"accent*",L:"0.62",C:"max(C, 0.22)",role:"Vivid mid-tone pop"},{pattern:"main* / primary* / brand*",L:"0.52",C:"max(C, 0.22)",role:"Core brand color"},{pattern:"background* / bg*",L:"0.97",C:"min(C×0.08, 0.012)",role:"Almost-white canvas"},{pattern:"surface*",L:"0.91",C:"min(C×0.18, 0.025)",role:"Elevated surface"},{pattern:"foreground* / text* / on*",L:"0.18",C:"min(C×0.12, 0.020)",role:"Dark readable text"}].map(({pattern:l,L:h,C:d,role:u},m)=>e.jsxs("tr",{style:{background:m%2===0?a.panelBg:"transparent"},children:[e.jsx("td",{children:e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:3,fontSize:11},children:l})}),e.jsx("td",{style:{fontVariantNumeric:"tabular-nums"},children:h}),e.jsx("td",{style:{fontSize:12},children:d}),e.jsx("td",{style:{color:a.desc,fontSize:12},children:u})]},m))})]})}),e.jsxs("p",{style:{color:a.body,marginTop:16,fontSize:13},children:["Resolution is first-match in order — more specific patterns appear before generic ones. A key named"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:"neutralLight"})," ","matches the first row, not the neutral-generic or *light row."]})]}),e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"04",title:"Step-by-Step Generation",accent:c}),e.jsxs("div",{className:"rad-step",children:[e.jsx("div",{className:"rad-step-num",style:{background:i+"20",color:i},children:"4a"}),e.jsxs("div",{className:"rad-step-body",children:[e.jsx("h3",{style:{color:a.label,margin:"0 0 8px"},children:"neutralLight — near-white tint"}),e.jsxs("p",{style:{color:a.body},children:["The goal is a page background: very light, almost achromatic, but carrying a whisper of the input hue. L is set to"," ",e.jsx("strong",{children:"0.93"})," (perceptually near-white) and chroma is aggressively drained to"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 4px",borderRadius:3},children:"min(C × 0.08, 0.015)"}),". At 8% of the original chroma, a vivid lime green (#88ff00, C=0.293) becomes a barely-tinted off-white (#e4eae0, C=0.015) — still green, just whispered."]}),e.jsx(w,{inputHex:f.neutralLight,outputHex:v.neutralLight,label:"neutralLight",targetL:"0.93 (fixed)",targetC:"min(C×0.08, 0.015)"})]})]}),e.jsxs("div",{className:"rad-step",children:[e.jsx("div",{className:"rad-step-num",style:{background:r+"20",color:r},children:"4b"}),e.jsxs("div",{className:"rad-step-body",children:[e.jsx("h3",{style:{color:a.label,margin:"0 0 8px"},children:"neutralDark — near-black shade"}),e.jsxs("p",{style:{color:a.body},children:["The structural skeleton — text, borders, and dark surfaces. Symmetrical to neutralLight: L is forced to"," ",e.jsx("strong",{children:"0.10"})," and chroma is drained to"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 4px",borderRadius:3},children:"min(C × 0.08, 0.015)"}),". A navy-blue input (#0e1626, H=227°) becomes a near-black with a faint blue ghost tint (#030304). The hue angle is preserved exactly; only L and C change."]}),e.jsx(w,{inputHex:f.neutralDark,outputHex:v.neutralDark,label:"neutralDark",targetL:"0.10 (fixed)",targetC:"min(C×0.08, 0.015)"})]})]}),e.jsxs("div",{className:"rad-step",children:[e.jsx("div",{className:"rad-step-num",style:{background:n+"20",color:n},children:"4c"}),e.jsxs("div",{className:"rad-step-body",children:[e.jsx("h3",{style:{color:a.label,margin:"0 0 8px"},children:"mainColor — vivid brand mid-tone"}),e.jsxs("p",{style:{color:a.body},children:["The core 30% brand color. L is set to ",e.jsx("strong",{children:"0.52"})," — the perceptual mid-tone that gives maximum contrast range (readable on both light and dark backgrounds). Chroma is floored at ",e.jsx("strong",{children:"0.22"})," to guarantee vividness:"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 4px",borderRadius:3},children:"max(C, 0.22)"}),". If the input already has higher chroma, it's preserved. A near-black indigo (#0008ff, C=0.311) becomes a vivid accessible blue (#104cff)."]}),e.jsx(w,{inputHex:f.mainColor,outputHex:v.mainColor,label:"mainColor",targetL:"0.52 (fixed)",targetC:"max(C, 0.22)"})]})]}),e.jsxs("div",{className:"rad-step",children:[e.jsx("div",{className:"rad-step-num",style:{background:i+"20",color:i},children:"4d"}),e.jsxs("div",{className:"rad-step-body",children:[e.jsx("h3",{style:{color:a.label,margin:"0 0 8px"},children:"mainColorShade — dark twin with exact hue"}),e.jsxs("p",{style:{color:a.body},children:["The shade is for hover states, gradient depth, and dark brand moments. L drops to ",e.jsx("strong",{children:"0.30"})," and chroma is left exactly as the input provides — no floor, no ceiling. This is the token most prone to gamut clipping: warm hues like orange (H≈49°) have very little sRGB headroom at low lightness. Without the gamut-safety step, #ff7700 would shift to red."]}),e.jsx(w,{inputHex:f.mainColorShade,outputHex:v.mainColorShade,label:"mainColorShade",targetL:"0.30 (fixed)",targetC:"preserved input C (gamut-safe)"})]})]}),e.jsxs("div",{className:"rad-step",children:[e.jsx("div",{className:"rad-step-num",style:{background:r+"20",color:r},children:"4e"}),e.jsxs("div",{className:"rad-step-body",children:[e.jsx("h3",{style:{color:a.label,margin:"0 0 8px"},children:"accentColor — vivid 10% pop"}),e.jsxs("p",{style:{color:a.body},children:["CTAs, badges, price highlights — the 10% surprise. L lands at"," ",e.jsx("strong",{children:"0.62"}),", slightly brighter than mainColor for extra pop, and the C floor of ",e.jsx("strong",{children:"0.22"})," guarantees vividness. An orange (#f87f01, C=0.180) gets its chroma boosted to 0.22 minimum, landing at a warm caramel (#cb6700)."]}),e.jsx(w,{inputHex:f.accentColor,outputHex:v.accentColor,label:"accentColor",targetL:"0.62 (fixed)",targetC:"max(C, 0.22)"})]})]})]}),e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"05",title:"Gamut Safety — The Binary-Search Clamp",accent:i}),e.jsxs("p",{style:{color:a.body},children:["Every OKLCH → sRGB conversion in Radium goes through"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:"lchToHexSafe"})," ","instead of the naive"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:"lchToHex"}),". The difference is critical for warm hues."]}),e.jsxs("div",{className:"rad-callout",style:{background:a.highlight,border:`1px solid ${i}30`},children:[e.jsx("div",{className:"rad-callout-label",style:{color:i},children:"The problem"}),e.jsx("p",{style:{color:a.body,margin:0,fontSize:13,lineHeight:1.6},children:"When an OKLCH color lies outside sRGB, the naive approach clamps each R, G, B channel independently to [0, 1]. For orange at H≈49° forced to L=0.30, the green and blue channels go negative. Clamping them to 0 produces a pure-red result — the hue drifts by 20° without any indication this happened."})]}),e.jsxs("div",{className:"rad-callout",style:{background:a.highlight,border:`1px solid ${r}30`,marginTop:12},children:[e.jsx("div",{className:"rad-callout-label",style:{color:r},children:"The fix — chroma binary search"}),e.jsxs("p",{style:{color:a.body,margin:0,fontSize:13,lineHeight:1.6},children:["Instead of clamping channels, we binary-search the chroma axis: find the maximum C value at the target (L, H) that still fits inside sRGB. The search uses the ",e.jsx("em",{children:"unclipped"})," RGB values — a critical implementation detail. The clamped conversion always returns channels in [0,1] and therefore always appears in-gamut, defeating the search entirely."]})]}),e.jsx(S,{lang:"ts",code:`const lchToHexSafe = (lch: LCH): string => {
  // Must use UNCLIPPED oklabToRgbRaw — clamped values
  // always appear "in gamut" and defeat the search.
  const inGamut = (rgb: RGB) =>
    rgb.r >= -0.001 && rgb.r <= 1.001 &&
    rgb.g >= -0.001 && rgb.g <= 1.001 &&
    rgb.b >= -0.001 && rgb.b <= 1.001;

  // Fast path: already in gamut
  const direct = oklabToRgbRaw(oklchToOklab(lch));
  if (inGamut(direct)) return rgbToHex(oklabToRgb(oklchToOklab(lch)));

  // Binary search: find max C that stays inside sRGB.
  // Hue is NEVER modified — only chroma is reduced.
  let lo = 0, hi = lch.C;
  for (let i = 0; i < 24; i++) {
    const mid = (lo + hi) / 2;
    if (inGamut(oklabToRgbRaw(oklchToOklab({ ...lch, C: mid }))))
      lo = mid;
    else
      hi = mid;
  }
  return rgbToHex(oklabToRgb(oklchToOklab({ ...lch, C: lo })));
};`}),e.jsxs("p",{style:{color:a.body,marginTop:16},children:["24 iterations gives precision of"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 4px",borderRadius:3},children:"C / 2²⁴ ≈ 0.000001"})," ","— well below any visible threshold. The chart below shows the sRGB gamut boundary (maximum reachable C at each L) for the orange hue H=49°. Notice how the boundary drops sharply below L=0.35: at L=0.30, the maximum C is only ~0.08, far below the nominal 0.19 of #ff7700."]}),e.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",alignItems:"flex-start",marginTop:16},children:[e.jsxs("div",{style:{flex:1,minWidth:200},children:[e.jsx("div",{className:"rad-callout-label",style:{color:a.faint,marginBottom:8},children:"Try different hues — watch the gamut boundary shift"}),e.jsxs("div",{className:"rad-slider-row",style:{marginBottom:0},children:[e.jsxs("span",{className:"rad-slider-label",style:{color:a.h2},children:["H = ",t,"°"]}),e.jsx("input",{type:"range",min:0,max:359,step:1,value:t,onChange:l=>o(parseInt(l.target.value)),className:"rad-slider",style:{"--slider-color":b({L:.6,C:.25,H:t})}})]})]}),e.jsx(U,{H:t,th:a})]})]}),e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"06",title:"Multi-Swatch Palettes",accent:n}),e.jsxs("p",{style:{color:a.body},children:["When a key's array has more than one swatch (",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:"n > 1"}),"), the semantic transform table is bypassed entirely and one of four ramp strategies is used instead:"]}),e.jsx("div",{className:"rad-multi-grid",children:[{title:"Named harmony",trigger:"Key matches triadic, square, splitComplementary, etc.",desc:"Applies a fixed hue-offset set (e.g. triadic = 0°, 120°, 240°) to the base LCH, cycling and slightly darkening repeated indices.",accent:i,swatches:[0,120,240].map(l=>b({L:.55,C:.22,H:(250+l)%360}))},{title:"Tint-shade ramp",trigger:"Key contains tint, shade, or tintshade",desc:"A power-curved L ramp from 0.10 (dark) to 0.96 (tint), with chroma easing near the extremes so mid-tones stay vivid.",accent:r,swatches:Array.from({length:6},(l,h)=>{const d=h/5,u=d<.5?.5*(d*2)**1.6:1-.5*((1-d)*2)**1.4;return b({L:.1+u*.86,C:.22*(1-((d-.4)/.7)**2*.6),H:250})})},{title:"Monochromatic ramp",trigger:"Key contains monochromatic",desc:"Linear L ramp 0.12 → 0.94, same hue throughout. Chroma peaks at L≈0.45 and fades at extremes using a power curve — matching how the eye perceives saturation.",accent:n,swatches:Array.from({length:6},(l,h)=>{const d=h/5;return b({L:.12+d*.82,C:.22*(1-Math.abs(d-.45)**2.5),H:250})})},{title:"Evenly-spaced hues",trigger:"Unknown key, n > 1",desc:"Divides 360° evenly by n and distributes hues around the wheel at constant L and C. A 4-swatch unknown key gets a tetradic-equivalent split.",accent:c,swatches:Array.from({length:4},(l,h)=>b({L:.55,C:.22,H:(250+360/4*h)%360}))}].map(({title:l,trigger:h,desc:d,accent:u,swatches:m})=>e.jsxs("div",{className:"rad-multi-card",style:{background:a.panelBg,border:`1px solid ${a.border}`},children:[e.jsxs("div",{className:"rad-multi-card-header",children:[e.jsx("div",{className:"rad-multi-dot",style:{background:u}}),e.jsx("strong",{style:{color:a.label,fontSize:13},children:l})]}),e.jsx("div",{className:"rad-multi-swatches",children:m.map((p,g)=>e.jsx("div",{style:{flex:1,height:32,background:p}},g))}),e.jsx("code",{style:{fontSize:10,color:u,display:"block",marginBottom:6,lineHeight:1.4},children:h}),e.jsx("p",{style:{color:a.desc,fontSize:12,margin:0,lineHeight:1.5},children:d})]},l))})]}),e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"07",title:"Per-Key Base Color",accent:r}),e.jsxs("p",{style:{color:a.body},children:["Each key extracts its base color from its"," ",e.jsx("em",{children:"own first hex value"}),". Early versions used a single global base extracted from the first valid hex anywhere in the input — meaning all keys shared the same hue, no matter what values were provided per-key. The fix is straightforward:"]}),e.jsx(S,{lang:"ts",code:`// ❌ Old — global base means all keys share one hue
const base = extractBaseColor(input);          // first hex in entire object
const lch  = hexToLch(base);
Object.entries(input).map(([key, colors]) => [key, generatePalette(key, lch, colors.length)]);

// ✅ New — per-key base, each key has independent hue
Object.entries(input).map(([key, colors]) => {
  const base = colors.find(c => HEX_RE.test(c)) ?? "#ff0000";  // own first hex
  const lch  = hexToLch(base);
  return [key, generatePalette(key, lch, colors.length)];
});`}),e.jsxs("p",{style:{color:a.body,marginTop:12},children:["This allows a palette like"," ",e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:4},children:'{ mainColor: ["#ff0000"], accentColor: ["#0000ff"] }'})," ","to produce a red main color and a blue accent — instead of two reds."]})]}),e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"08",title:"Full Before / After",accent:c}),e.jsx("p",{style:{color:a.body},children:"Here's the complete transformation for the canonical test case, showing every token's input → output alongside its OKLCH coordinates:"}),e.jsx("div",{className:"rad-full-table-wrap",children:e.jsxs("table",{className:"rad-full-table",style:{color:a.body},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{color:a.h2},children:"Token"}),e.jsx("th",{style:{color:a.h2},children:"Input"}),e.jsx("th",{style:{color:a.h2},children:"L C H (in)"}),e.jsx("th",{style:{color:a.h2},children:"Output"}),e.jsx("th",{style:{color:a.h2},children:"L C H (out)"}),e.jsx("th",{style:{color:a.h2},children:"ΔH"})]})}),e.jsx("tbody",{children:x.map(l=>{const h=f[l],d=v[l],u=N(h),m=N(d),p=Math.min(Math.abs(m.H-u.H),360-Math.abs(m.H-u.H));return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("code",{style:{background:a.codeBg,color:a.codeText,padding:"1px 5px",borderRadius:3,fontSize:11},children:l})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("div",{style:{width:20,height:20,borderRadius:4,background:h,flexShrink:0}}),e.jsx("code",{style:{fontSize:11},children:h})]})}),e.jsxs("td",{style:{fontSize:11,fontVariantNumeric:"tabular-nums",color:a.desc},children:[u.L.toFixed(3)," ",u.C.toFixed(3)," ",u.H.toFixed(1),"°"]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("div",{style:{width:20,height:20,borderRadius:4,background:d,flexShrink:0}}),e.jsx("code",{style:{fontSize:11},children:d})]})}),e.jsxs("td",{style:{fontSize:11,fontVariantNumeric:"tabular-nums",color:a.desc},children:[m.L.toFixed(3)," ",m.C.toFixed(3)," ",m.H.toFixed(1),"°"]}),e.jsxs("td",{style:{color:p<2?r:p<8?n:"#ef4444",fontWeight:600,fontSize:11},children:[p.toFixed(1),"°"]})]},l)})})]})}),e.jsx("p",{style:{color:a.desc,fontSize:12,marginTop:8},children:"ΔH (hue drift): green = excellent (<2°) · orange = acceptable (<8°) · red = problem (>8°). All values should be green after gamut-safe clamping."})]}),e.jsxs("section",{className:"rad-section",children:[e.jsx(y,{number:"09",title:"Summary",accent:i}),e.jsx("div",{className:"rad-summary-grid",children:[{icon:"⬡",title:"OKLCH everywhere",desc:"All transforms target absolute (L, C, H) coordinates. Perceptual uniformity guarantees consistency regardless of input.",accent:i},{icon:"⊕",title:"Per-key independence",desc:"Each token uses its own first hex value as a base. Keys can carry completely different hues.",accent:r},{icon:"⟳",title:"Gamut-safe binary search",desc:"Chroma is binary-searched downward until the color fits inside sRGB. Hue is never altered by the clamp.",accent:n},{icon:"◈",title:"Semantic pattern table",desc:"11 priority-ordered key patterns map token names to specific L and C transforms. First match wins.",accent:c},{icon:"▦",title:"Ramp strategies for n > 1",desc:"Named harmonies, tint-shade ramps, monochromatic ramps, and evenly-spaced hues for multi-swatch keys.",accent:i},{icon:"≡",title:"Structure preserved",desc:"Output always mirrors the input: same keys, same array lengths. Unknown keys fall back gracefully.",accent:r}].map(({icon:l,title:h,desc:d,accent:u})=>e.jsxs("div",{className:"rad-summary-card",style:{background:a.panelBg,border:`1px solid ${a.border}`},children:[e.jsx("div",{className:"rad-summary-icon",style:{color:u},children:l}),e.jsx("div",{className:"rad-summary-title",style:{color:a.label},children:h}),e.jsx("p",{style:{color:a.desc,fontSize:12,margin:0,lineHeight:1.5},children:d})]},h))})]})]}),e.jsx(E,{})]})}export{V as Swatch,q as default};
